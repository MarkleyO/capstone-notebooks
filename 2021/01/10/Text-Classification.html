<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Text Classification | fastpages</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="Text Classification" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Chapter 1 - learn about using a neural network to classify text using sentiment (positive or negative)." />
<meta property="og:description" content="Chapter 1 - learn about using a neural network to classify text using sentiment (positive or negative)." />
<link rel="canonical" href="https://laurajjiang.github.io/capstone-notebooks/2021/01/10/Text-Classification.html" />
<meta property="og:url" content="https://laurajjiang.github.io/capstone-notebooks/2021/01/10/Text-Classification.html" />
<meta property="og:site_name" content="fastpages" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-01-10T00:00:00-06:00" />
<script type="application/ld+json">
{"url":"https://laurajjiang.github.io/capstone-notebooks/2021/01/10/Text-Classification.html","@type":"BlogPosting","headline":"Text Classification","dateModified":"2021-01-10T00:00:00-06:00","datePublished":"2021-01-10T00:00:00-06:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://laurajjiang.github.io/capstone-notebooks/2021/01/10/Text-Classification.html"},"description":"Chapter 1 - learn about using a neural network to classify text using sentiment (positive or negative).","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/capstone-notebooks/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://laurajjiang.github.io/capstone-notebooks/feed.xml" title="fastpages" /><link rel="shortcut icon" type="image/x-icon" href="/capstone-notebooks/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />

<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/capstone-notebooks/">fastpages</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/capstone-notebooks/about/">About Me</a><a class="page-link" href="/capstone-notebooks/search/">Search</a><a class="page-link" href="/capstone-notebooks/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Text Classification</h1><p class="page-description">Chapter 1 - learn about using a neural network to classify text using sentiment (positive or negative).</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2021-01-10T00:00:00-06:00" itemprop="datePublished">
        Jan 10, 2021
      </time>
       • <span class="read-time" title="Estimated read time">
    
    
      11 min read
    
</span></p>

    

    
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul class="section-nav">
<li class="toc-entry toc-h1"><a href="#Introduction">Introduction </a></li>
<li class="toc-entry toc-h1"><a href="#Set-up-data-and-imports">Set up data and imports </a>
<ul>
<li class="toc-entry toc-h2"><a href="#Library-imports">Library imports </a></li>
<li class="toc-entry toc-h2"><a href="#Getting-our-data ">Getting our data  </a></li>
<li class="toc-entry toc-h2"><a href="#Pre-processing-our-data ">Pre-processing our data  </a></li>
<li class="toc-entry toc-h2"><a href="#Vectorizing-our-data">Vectorizing our data </a></li>
</ul>
</li>
<li class="toc-entry toc-h1"><a href="#A-Naive-Bayes-model">A Naive Bayes model </a>
<ul>
<li class="toc-entry toc-h2"><a href="#Creating-and-Training-our-Model">Creating and Training our Model </a></li>
<li class="toc-entry toc-h2"><a href="#Visualizing-Results">Visualizing Results </a></li>
<li class="toc-entry toc-h2"><a href="#A-Closer-Look">A Closer Look </a></li>
</ul>
</li>
</ul><!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2021-01-10-Text Classification.ipynb
-->

<div class="container" id="notebook-container">
        
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Introduction">
<a class="anchor" href="#Introduction" aria-hidden="true"><span class="octicon octicon-link"></span></a>Introduction<a class="anchor-link" href="#Introduction"> </a>
</h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Text classification is the process of assigning tags or categories to text according to its content. It’s one of the fundamental tasks in natural language processing.</p>
<p>The text we wanna classify is given as input to an algorithm, the algorithm will then analyze the text’s content, and then categorize the input as one of the tags or categories previously given.</p>
<p><strong>Input → Classifying Algorithm → Classification of Input</strong></p>
<p>Real life examples:</p>
<ul>
<li>Sentiment analysis: how does the writer of the sentence feel about what they are writing about, do they think positively or negatively of the subject? Ex. restaurant reviews topic labeling: given sentences and a set of topics, which topic does this sentence fall under? Ex. is this essay about history? Math? etc? spam detection Ex. Email filtering: is this email a real important email or spam?</li>
</ul>
<p>Example. A restaurant wants to evaluate their ratings but don’t want to read through all of them. Therefore, they wanna use a computer algorithm to do all their work. They simply want to know if the customer’s review is positive or negative.</p>
<p>Here’s an example of a customer’s review and a simple way an algorithm could classify their review.</p>
<p>Input: “The food here was too salty and too expensive”</p>
<p>Algorithm: Goes through every word in the sentence and counts how many positive words and how many negative words are in the sentence.</p>

<pre><code>    “The, food, here, was, too, and” are all neutral words

    “Salty, expensive” are negative words.

    Negative words: 2
    Positive words: 0</code></pre>
<p>Classification: Negative Review, because there are more negative words (2) than positive (0).</p>
<p>However, this algorithm obviously doesn’t work in a lot of cases.</p>
<p>For example, “The food here was good, not expensive and not salty” would be classified as negative but it’s actually a positive review.</p>
<p>Language and text can get very complicated which makes creating these algorithms difficult. Some things that make language difficult could be words that have multiple meanings, negation words (words such as not), slang, etc.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Set-up-data-and-imports">
<a class="anchor" href="#Set-up-data-and-imports" aria-hidden="true"><span class="octicon octicon-link"></span></a>Set up data and imports<a class="anchor-link" href="#Set-up-data-and-imports"> </a>
</h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Library-imports">
<a class="anchor" href="#Library-imports" aria-hidden="true"><span class="octicon octicon-link"></span></a>Library imports<a class="anchor-link" href="#Library-imports"> </a>
</h2>
<p>This section of code is to import any necessary Python libraries that we'll need for the rest of this notebook. Some packages may need to be installed since they are not built in to Python3.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>pip3 install seaborn
<span class="o">!</span>pip3 install plotly --user
<span class="o">!</span>pip3 install sklearn

<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">string</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">sparse</span>
<span class="kn">from</span> <span class="nn">pprint</span> <span class="kn">import</span> <span class="n">pprint</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">plotly.offline</span> <span class="k">as</span> <span class="nn">py</span>
<span class="kn">from</span> <span class="nn">plotly.offline</span> <span class="kn">import</span> <span class="n">init_notebook_mode</span><span class="p">,</span> <span class="n">iplot</span>
<span class="kn">import</span> <span class="nn">plotly.graph_objs</span> <span class="k">as</span> <span class="nn">go</span>
<span class="n">init_notebook_mode</span><span class="p">(</span><span class="n">connected</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">html</span> <span class="kn">import</span> <span class="n">escape</span>
<span class="kn">from</span> <span class="nn">IPython.core.display</span> <span class="kn">import</span> <span class="n">display</span><span class="p">,</span> <span class="n">HTML</span>
<span class="kn">from</span> <span class="nn">string</span> <span class="kn">import</span> <span class="n">Template</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">classification_report</span>
<span class="kn">import</span> <span class="nn">json</span>

<span class="n">HTML</span><span class="p">(</span><span class="s1">'&lt;script src="https://d3js.org/d3.v3.min.js" charset="utf-8"&gt;&lt;/script&gt;'</span><span class="p">)</span>

<span class="c1"># Our two files that contain our data, split up into a training set and a testing set.</span>

<span class="n">trainingFile</span> <span class="o">=</span> <span class="s2">"trainingSet.txt"</span>
<span class="n">testingFile</span> <span class="o">=</span> <span class="s2">"testSet.txt"</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Requirement already satisfied: seaborn in /usr/local/lib/python3.9/site-packages (0.11.1)
Requirement already satisfied: numpy&gt;=1.15 in /usr/local/lib/python3.9/site-packages (from seaborn) (1.19.5)
Requirement already satisfied: pandas&gt;=0.23 in /usr/local/lib/python3.9/site-packages (from seaborn) (1.2.0)
Requirement already satisfied: scipy&gt;=1.0 in /usr/local/lib/python3.9/site-packages (from seaborn) (1.6.0)
Requirement already satisfied: matplotlib&gt;=2.2 in /usr/local/lib/python3.9/site-packages (from seaborn) (3.3.3)
Requirement already satisfied: python-dateutil&gt;=2.7.3 in /usr/local/lib/python3.9/site-packages (from pandas&gt;=0.23-&gt;seaborn) (2.8.1)
Requirement already satisfied: pytz&gt;=2017.3 in /usr/local/lib/python3.9/site-packages (from pandas&gt;=0.23-&gt;seaborn) (2020.5)
Requirement already satisfied: pillow&gt;=6.2.0 in /usr/local/lib/python3.9/site-packages (from matplotlib&gt;=2.2-&gt;seaborn) (8.1.0)
Requirement already satisfied: cycler&gt;=0.10 in /usr/local/lib/python3.9/site-packages (from matplotlib&gt;=2.2-&gt;seaborn) (0.10.0)
Requirement already satisfied: kiwisolver&gt;=1.0.1 in /usr/local/lib/python3.9/site-packages (from matplotlib&gt;=2.2-&gt;seaborn) (1.3.1)
Requirement already satisfied: pyparsing!=2.0.4,!=2.1.2,!=2.1.6,&gt;=2.0.3 in /usr/local/lib/python3.9/site-packages (from matplotlib&gt;=2.2-&gt;seaborn) (2.4.7)
Requirement already satisfied: six&gt;=1.5 in /usr/local/lib/python3.9/site-packages (from python-dateutil&gt;=2.7.3-&gt;pandas&gt;=0.23-&gt;seaborn) (1.15.0)
Requirement already satisfied: plotly in /Users/laurajiang/Library/Python/3.9/lib/python/site-packages (4.14.3)
Requirement already satisfied: retrying&gt;=1.3.3 in /Users/laurajiang/Library/Python/3.9/lib/python/site-packages (from plotly) (1.3.3)
Requirement already satisfied: six in /usr/local/lib/python3.9/site-packages (from plotly) (1.15.0)
Requirement already satisfied: sklearn in /usr/local/lib/python3.9/site-packages (0.0)
Requirement already satisfied: scikit-learn in /usr/local/lib/python3.9/site-packages (from sklearn) (0.24.1)
Requirement already satisfied: joblib&gt;=0.11 in /usr/local/lib/python3.9/site-packages (from scikit-learn-&gt;sklearn) (1.0.0)
Requirement already satisfied: threadpoolctl&gt;=2.0.0 in /usr/local/lib/python3.9/site-packages (from scikit-learn-&gt;sklearn) (2.1.0)
Requirement already satisfied: scipy&gt;=0.19.1 in /usr/local/lib/python3.9/site-packages (from scikit-learn-&gt;sklearn) (1.6.0)
Requirement already satisfied: numpy&gt;=1.13.3 in /usr/local/lib/python3.9/site-packages (from scikit-learn-&gt;sklearn) (1.19.5)
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
        <script type="text/javascript">
        window.PlotlyConfig = {MathJaxConfig: 'local'};
        if (window.MathJax) {MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}
        if (typeof require !== 'undefined') {
        require.undef("plotly");
        requirejs.config({
            paths: {
                'plotly': ['https://cdn.plot.ly/plotly-latest.min']
            }
        });
        require(['plotly'], function(Plotly) {
            window._Plotly = Plotly;
        });
        }
        </script>
        
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Getting-our-data ">
<a class="anchor" href="#Getting-our-data%C2%A0" aria-hidden="true"><span class="octicon octicon-link"></span></a>Getting our data <a class="anchor-link" href="#Getting-our-data%C2%A0"> </a>
</h2>
<p>Below is a definition of getData, a basic function to pull from the <code>trainingSet.txt</code> and <code>testSet.txt</code>. The data that we're using for this example is a set of reviews written by users on Yelp, classified as positive (1) or negative (0). </p>
<p>We open the file, create temporary arrays, and pull from the file line by line.</p>
<p>Open the cell if you'd like to peek into what the function looks like.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">getData</span><span class="p">(</span><span class="n">fileName</span><span class="p">):</span>
    <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">fileName</span><span class="p">)</span>
    <span class="n">file</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>

    <span class="n">sentences</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">sentiments</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">file</span><span class="p">:</span>
        <span class="n">sentence</span><span class="p">,</span> <span class="n">sentiment</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">'</span><span class="se">\t</span><span class="s1">'</span><span class="p">)</span>
        <span class="n">sentences</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sentence</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
        <span class="n">sentiments</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">sentiment</span><span class="o">.</span><span class="n">strip</span><span class="p">()))</span> <span class="c1"># Sentiment in {0,1}</span>

    <span class="k">return</span> <span class="n">sentences</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">sentiments</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

    </details>
</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">trainingSentences</span><span class="p">,</span> <span class="n">trainingLabels</span> <span class="o">=</span> <span class="n">getData</span><span class="p">(</span><span class="n">trainingFile</span><span class="p">)</span>
<span class="n">testingSentences</span><span class="p">,</span> <span class="n">testingLabels</span> <span class="o">=</span> <span class="n">getData</span><span class="p">(</span><span class="n">testingFile</span><span class="p">)</span> 
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's take a peek at what this data looks like:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">"trainingSet.txt"</span><span class="p">)</span>
<span class="n">file</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>

<span class="n">sentences</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">sentiments</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">file</span><span class="p">:</span>
    <span class="n">sentence</span><span class="p">,</span> <span class="n">sentiment</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">'</span><span class="se">\t</span><span class="s1">'</span><span class="p">)</span>
    <span class="n">sentences</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sentence</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
    <span class="n">sentiments</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">sentiment</span><span class="o">.</span><span class="n">strip</span><span class="p">()))</span> 
    
<span class="nb">print</span><span class="p">(</span><span class="s2">"Sample sentences:"</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">sentences</span><span class="p">[:</span><span class="mi">10</span><span class="p">])</span> 
<span class="nb">print</span><span class="p">(</span><span class="s2">"Corresponding sentiments:"</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">sentiments</span><span class="p">[:</span><span class="mi">10</span><span class="p">])</span> 
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Sample sentences:
['Wow... Loved this place.',
 'Not tasty and the texture was just nasty.',
 'Stopped by during the late May bank holiday off Rick Steve recommendation '
 'and loved it.',
 'The selection on the menu was great and so were the prices.',
 'Now I am getting angry and I want my damn pho.',
 "Honeslty it didn't taste THAT fresh.)",
 'The potatoes were like rubber and you could tell they had been made up ahead '
 'of time being kept under a warmer.',
 'The fries were great too.',
 'A great touch.',
 'Service was very prompt.']
Corresponding sentiments:
[1, 0, 1, 1, 0, 0, 0, 1, 1, 1]
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Pre-processing-our-data ">
<a class="anchor" href="#Pre-processing-our-data%C2%A0" aria-hidden="true"><span class="octicon octicon-link"></span></a>Pre-processing our data <a class="anchor-link" href="#Pre-processing-our-data%C2%A0"> </a>
</h2>
<p>We need to modify these sentences by tokenizing them into individual strings (word by word) so that we can feed our model individual words and their associated sentiment (negative / positive).</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">preProcess</span><span class="p">(</span><span class="n">sentences</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">cleanText</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
        <span class="c1"># Make lower case</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>

        <span class="c1"># Replace non-text characters with spaces</span>
        <span class="n">nonText</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">punctuation</span> <span class="o">+</span> <span class="p">(</span><span class="s2">""</span><span class="p">)</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="nb">str</span><span class="o">.</span><span class="n">maketrans</span><span class="p">(</span><span class="n">nonText</span><span class="p">,</span> <span class="s1">' '</span> <span class="o">*</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">nonText</span><span class="p">))))</span>

        <span class="c1"># Split sentences into individual words - tokenize</span>
        <span class="n">words</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">words</span>

    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">cleanText</span><span class="p">,</span> <span class="n">sentences</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">trainingTokens</span> <span class="o">=</span> <span class="n">preProcess</span><span class="p">(</span><span class="n">trainingSentences</span><span class="p">)</span>
<span class="n">testingTokens</span> <span class="o">=</span> <span class="n">preProcess</span><span class="p">(</span><span class="n">testingSentences</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's look at what these tokenized sentences look like now:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">"Training tokens:"</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">trainingTokens</span><span class="p">[:</span><span class="mi">2</span><span class="p">])</span> 
<span class="nb">print</span><span class="p">(</span><span class="s2">"Testing tokens:"</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">testingTokens</span><span class="p">[:</span><span class="mi">3</span><span class="p">])</span> 
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Training tokens:
[['wow', 'loved', 'this', 'place'],
 ['not', 'tasty', 'and', 'the', 'texture', 'was', 'just', 'nasty']]
Testing tokens:
[['crust', 'is', 'not', 'good'],
 ['would', 'not', 'go', 'back'],
 ['i', 'was', 'shocked', 'because', 'no', 'signs', 'indicate', 'cash', 'only']]
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Vectorizing-our-data">
<a class="anchor" href="#Vectorizing-our-data" aria-hidden="true"><span class="octicon octicon-link"></span></a>Vectorizing our data<a class="anchor-link" href="#Vectorizing-our-data"> </a>
</h2>
<p>Now that we have our sentences tokenized, notice how our training tokens are nested arrays. We want to pull them out of nested arrays and into just one general vocabulary list.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">getVocab</span><span class="p">(</span><span class="n">sentences</span><span class="p">):</span>
    <span class="n">vocab</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">sentence</span> <span class="ow">in</span> <span class="n">sentences</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">sentence</span><span class="p">:</span>
            <span class="n">vocab</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">vocab</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

    </details>
</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vocabulary</span> <span class="o">=</span> <span class="n">getVocab</span><span class="p">(</span><span class="n">trainingTokens</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can peek at our vocabulary list, an alphabetically sorted list of words, now at a random set of indices:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pprint</span><span class="p">(</span><span class="n">vocabulary</span><span class="p">[</span><span class="mi">50</span><span class="p">:</span><span class="mi">70</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>['amount',
 'an',
 'and',
 'angry',
 'another',
 'anticipated',
 'any',
 'anything',
 'anytime',
 'anyway',
 'apologize',
 'app',
 'appalling',
 'appetizers',
 'apple',
 'approval',
 'are',
 'area',
 'aren',
 'aria']
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We want our arrays to actually be proper vectors to feed to our model, which we'll create below as well. This function, <code>createVector</code> transforms our arrays into vectors.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">createVector</span><span class="p">(</span><span class="n">vocab</span><span class="p">,</span> <span class="n">sentences</span><span class="p">):</span>
    <span class="n">indices</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">wordOccurrences</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">sentenceIndex</span><span class="p">,</span> <span class="n">sentence</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sentences</span><span class="p">):</span>
        <span class="n">alreadyCounted</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span> <span class="c1"># Keep track of words so we don't double count.</span>
        <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">sentence</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">word</span> <span class="ow">in</span> <span class="n">vocab</span><span class="p">)</span> <span class="ow">and</span> <span class="n">word</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">alreadyCounted</span><span class="p">:</span>
                <span class="c1"># If we just want {0,1} for the presence of the word (bernoulli NB),</span>
                <span class="c1"># only count each word once. Otherwise (multinomial NB) count each</span>
                <span class="c1"># occurrence of the word.</span>
                
            
                <span class="c1">#which sentence, which word</span>
                <span class="n">indices</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">sentenceIndex</span><span class="p">,</span> <span class="n">vocab</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">word</span><span class="p">)))</span>
                
                <span class="n">wordOccurrences</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">alreadyCounted</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>

    <span class="c1"># Unzip</span>
    <span class="n">rows</span> <span class="o">=</span> <span class="p">[</span><span class="n">row</span> <span class="k">for</span> <span class="n">row</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">]</span>
    <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">column</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">]</span>

    <span class="n">sentenceVectors</span> <span class="o">=</span> <span class="n">sparse</span><span class="o">.</span><span class="n">csr_matrix</span><span class="p">((</span><span class="n">wordOccurrences</span><span class="p">,</span> <span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">columns</span><span class="p">)),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sentences</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">vocab</span><span class="p">)))</span>

    <span class="k">return</span> <span class="n">sentenceVectors</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">training</span> <span class="o">=</span> <span class="n">createVector</span><span class="p">(</span><span class="n">vocabulary</span><span class="p">,</span> <span class="n">trainingTokens</span><span class="p">)</span>
<span class="n">testing</span> <span class="o">=</span> <span class="n">createVector</span><span class="p">(</span><span class="n">vocabulary</span><span class="p">,</span> <span class="n">testingTokens</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Our training and test data has gone through some transformation. Here's what the training data looks like now:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">"Training data:"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">training</span><span class="p">[:</span><span class="mi">2</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Training data:
  (0, 694)	1
  (0, 884)	1
  (0, 1186)	1
  (0, 1335)	1
  (1, 52)	1
  (1, 640)	1
  (1, 768)	1
  (1, 788)	1
  (1, 1158)	1
  (1, 1166)	1
  (1, 1171)	1
  (1, 1281)	1
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="A-Naive-Bayes-model">
<a class="anchor" href="#A-Naive-Bayes-model" aria-hidden="true"><span class="octicon octicon-link"></span></a>A Naive Bayes model<a class="anchor-link" href="#A-Naive-Bayes-model"> </a>
</h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Creating-and-Training-our-Model">
<a class="anchor" href="#Creating-and-Training-our-Model" aria-hidden="true"><span class="octicon octicon-link"></span></a>Creating and Training our Model<a class="anchor-link" href="#Creating-and-Training-our-Model"> </a>
</h2>
<p>Below is our Naive Bayes classifier, which is the model we've chosen to use for our sentiment analysis of restaurant reviews.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">NaiveBayesClassifier</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">priorPositive</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># Probability that a review is positive</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">priorNegative</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># Probability that a review is negative</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">positiveLogConditionals</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">negativeLogConditionals</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">computePriorProbabilities</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">labels</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">priorPositive</span> <span class="o">=</span> <span class="nb">len</span><span class="p">([</span><span class="n">y</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">labels</span> <span class="k">if</span> <span class="n">y</span> <span class="o">==</span> <span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">priorNegative</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">priorPositive</span>

    <span class="k">def</span> <span class="nf">computeConditionProbabilities</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">examples</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">dirichlet</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">vocabularyLength</span> <span class="o">=</span> <span class="n">examples</span><span class="o">.</span><span class="n">shape</span>

        <span class="c1"># How many of each word are there in all of the positive reviews</span>
        <span class="n">positiveCounts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">dirichlet</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">vocabularyLength</span><span class="p">)])</span>
        <span class="c1"># How many of each word are there in all of the negative reviews</span>
        <span class="n">negativeCounts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">dirichlet</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">vocabularyLength</span><span class="p">)])</span>

        <span class="c1"># Here's how to iterate through a spare array</span>
        <span class="n">coordinates</span> <span class="o">=</span> <span class="n">examples</span><span class="o">.</span><span class="n">tocoo</span><span class="p">()</span>  <span class="c1"># Converted to a `coordinate` format</span>
        <span class="k">for</span> <span class="n">exampleIndex</span><span class="p">,</span> <span class="n">featureIndex</span><span class="p">,</span> <span class="n">observationCount</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">coordinates</span><span class="o">.</span><span class="n">row</span><span class="p">,</span> <span class="n">coordinates</span><span class="o">.</span><span class="n">col</span><span class="p">,</span> <span class="n">coordinates</span><span class="o">.</span><span class="n">data</span><span class="p">):</span>
            <span class="c1"># For sentence {exampleIndex}, for word at index {featureIndex}, the word occurred {observationCount} times</span>
            <span class="k">if</span> <span class="n">labels</span><span class="p">[</span><span class="n">exampleIndex</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">positiveCounts</span><span class="p">[</span><span class="n">featureIndex</span><span class="p">]</span> <span class="o">+=</span> <span class="n">observationCount</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">negativeCounts</span><span class="p">[</span><span class="n">featureIndex</span><span class="p">]</span> <span class="o">+=</span> <span class="n">observationCount</span>

        <span class="c1"># [!] Make sure to use the logs of the probabilities</span>
        <span class="n">positiveReviewCount</span> <span class="o">=</span> <span class="nb">len</span><span class="p">([</span><span class="n">y</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">labels</span> <span class="k">if</span> <span class="n">y</span> <span class="o">==</span> <span class="mi">1</span><span class="p">])</span>
        <span class="n">negativeReviewCount</span> <span class="o">=</span> <span class="nb">len</span><span class="p">([</span><span class="n">y</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">labels</span> <span class="k">if</span> <span class="n">y</span> <span class="o">==</span> <span class="mi">0</span><span class="p">])</span>

        <span class="c1"># We are using bernoulli NB (single occurance of a word)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">positiveLogConditionals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">positiveCounts</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">positiveReviewCount</span> <span class="o">+</span> <span class="n">dirichlet</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">negativeLogConditionals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">negativeCounts</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">negativeReviewCount</span> <span class="o">+</span> <span class="n">dirichlet</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span>

        <span class="c1"># This works for multinomial NB (multiple occurances of a word)</span>
        <span class="c1"># self.positiveLogConditionals = np.log(positiveCounts) - np.log(sum(positiveCounts))</span>
        <span class="c1"># self.negativeLogConditionals = np.log(negativeCounts) - np.log(sum(negativeCounts))</span>

    <span class="c1"># Calculate all of the parameters for making a naive bayes classification</span>
    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trainingExamples</span><span class="p">,</span> <span class="n">trainingLabels</span><span class="p">):</span>
        <span class="c1"># Compute the probability of positive/negative review</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">computePriorProbabilities</span><span class="p">(</span><span class="n">trainingLabels</span><span class="p">)</span>

        <span class="c1"># Compute</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">computeConditionProbabilities</span><span class="p">(</span><span class="n">trainingExamples</span><span class="p">,</span> <span class="n">trainingLabels</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">computeLogPosteriors</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sentence</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">priorPositive</span><span class="p">)</span> <span class="o">+</span> <span class="nb">sum</span><span class="p">(</span><span class="n">sentence</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">positiveLogConditionals</span><span class="p">)),</span>
                <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">priorNegative</span><span class="p">)</span> <span class="o">+</span> <span class="nb">sum</span><span class="p">(</span><span class="n">sentence</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">negativeLogConditionals</span><span class="p">)))</span>
 
    <span class="c1"># Have the model try predicting if a review if positive or negative</span>
    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">examples</span><span class="p">):</span>
        <span class="n">totalReviewCount</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">examples</span><span class="o">.</span><span class="n">shape</span>
        <span class="n">conf_list</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">predictions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">totalReviewCount</span><span class="p">)])</span>

        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">sentence</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">examples</span><span class="p">):</span>
            <span class="n">logProbabilityPositive</span><span class="p">,</span> <span class="n">logProbabilityNegative</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeLogPosteriors</span><span class="p">(</span>
                <span class="n">sentence</span><span class="p">)</span>
            <span class="n">conf_list</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">logProbabilityPositive</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">logProbabilityNegative</span><span class="p">)])</span>
            <span class="n">predictions</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">logProbabilityPositive</span> <span class="o">&gt;</span> <span class="n">logProbabilityNegative</span> <span class="k">else</span> <span class="mi">0</span>

        <span class="k">return</span> <span class="n">conf_list</span><span class="p">,</span> <span class="n">predictions</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Initialize an instance of model and begin to fit the model with our training data and corresponding labels.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">nbClassifier</span> <span class="o">=</span> <span class="n">NaiveBayesClassifier</span><span class="p">()</span>
<span class="n">nbClassifier</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">training</span><span class="p">,</span> <span class="n">trainingLabels</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">accuracy</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="n">actual</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">sum</span><span class="p">((</span><span class="n">predictions</span> <span class="o">==</span> <span class="n">actual</span><span class="p">))</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">actual</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's take our model for a spin, using both the training set and the testing set. You may notice discrepencies in accuracy between training and testing - <em>why is that</em>?</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train_confidence_scores</span><span class="p">,</span> <span class="n">trainingPredictions</span> <span class="o">=</span> <span class="n">nbClassifier</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">training</span><span class="p">)</span>
<span class="n">test_confidence_scores</span><span class="p">,</span> <span class="n">testingPredictions</span> <span class="o">=</span> <span class="n">nbClassifier</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">testing</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">"Training accuracy:"</span><span class="p">,</span> <span class="n">accuracy</span><span class="p">(</span><span class="n">trainingPredictions</span><span class="p">,</span> <span class="n">trainingLabels</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Testing accuracy:"</span><span class="p">,</span> <span class="n">accuracy</span><span class="p">(</span><span class="n">testingPredictions</span><span class="p">,</span> <span class="n">testingLabels</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Training accuracy: 0.9519038076152304
Testing accuracy: 0.7947686116700201
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Visualizing-Results">
<a class="anchor" href="#Visualizing-Results" aria-hidden="true"><span class="octicon octicon-link"></span></a>Visualizing Results<a class="anchor-link" href="#Visualizing-Results"> </a>
</h2>
<p>Here's another to visualize our results using a confusion matrix.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'Actual'</span><span class="p">:</span>    <span class="n">testingLabels</span><span class="p">,</span>
        <span class="s1">'Predicted'</span><span class="p">:</span> <span class="n">testingPredictions</span>
        <span class="p">}</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">'Actual'</span><span class="p">,</span><span class="s1">'Predicted'</span><span class="p">])</span>
<span class="n">confusion_matrix</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">'Actual'</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">'Predicted'</span><span class="p">],</span> <span class="n">rownames</span><span class="o">=</span><span class="p">[</span><span class="s1">'Actual'</span><span class="p">],</span> <span class="n">colnames</span><span class="o">=</span><span class="p">[</span><span class="s1">'Predicted'</span><span class="p">])</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">confusion_matrix</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s2">"YlGnBu"</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mf">2.0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'Confusion Matrix of Testing'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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%0A">
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="A-Closer-Look">
<a class="anchor" href="#A-Closer-Look" aria-hidden="true"><span class="octicon octicon-link"></span></a>A Closer Look<a class="anchor-link" href="#A-Closer-Look"> </a>
</h2>
<p>Let's look at the general results for our model - notably, we can look at its precision for predicting negative and positive sentiment in a given sentence.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">target_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'negative'</span><span class="p">,</span> <span class="s1">'positive'</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">testingLabels</span><span class="p">,</span> <span class="n">testingPredictions</span><span class="p">,</span> <span class="n">target_names</span><span class="o">=</span><span class="n">target_names</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-1-73b7949ec6a0&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-intense-fg ansi-bold">      1</span> target_names <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">'negative'</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">'positive'</span><span class="ansi-blue-fg">]</span>
<span class="ansi-green-fg">----&gt; 2</span><span class="ansi-red-fg"> </span>print<span class="ansi-blue-fg">(</span>classification_report<span class="ansi-blue-fg">(</span>testingLabels<span class="ansi-blue-fg">,</span> testingPredictions<span class="ansi-blue-fg">,</span> target_names<span class="ansi-blue-fg">=</span>target_names<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>

<span class="ansi-red-fg">NameError</span>: name 'classification_report' is not defined</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now, we want to make an interactive confusion matrix so we can precisely see which results are accurately classified and which are mis-classified, as well as the confidence at which the model has classified that result.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># work with the model results to create a JSON dump of the data for future use</span>

<span class="kn">import</span> <span class="nn">json</span>

<span class="n">output_filename</span> <span class="o">=</span> <span class="s2">"predict.json"</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">testingPredictions</span><span class="p">)):</span>
  <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
      <span class="s1">'index'</span><span class="p">:</span> <span class="n">i</span><span class="p">,</span>
      <span class="s1">'true_label'</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">testingLabels</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span>
      <span class="s1">'predicted_label'</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">testingPredictions</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span>
      <span class="s1">'confidence_score'</span><span class="p">:</span> <span class="n">test_confidence_scores</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
      <span class="s1">'text'</span><span class="p">:</span> <span class="n">testingSentences</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
  <span class="p">})</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">output_filename</span><span class="p">,</span> <span class="s1">'w'</span><span class="p">)</span> <span class="k">as</span> <span class="n">outfile</span><span class="p">:</span>
    <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">outfile</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

    </details>
</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">IPython.core.display</span> <span class="kn">import</span> <span class="n">display</span><span class="p">,</span> <span class="n">HTML</span>
<span class="kn">from</span> <span class="nn">string</span> <span class="kn">import</span> <span class="n">Template</span>


<span class="n">json_filepath</span> <span class="o">=</span> <span class="s2">"</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">output_filename</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2">"</span>
<span class="n">HTML</span><span class="p">(</span><span class="s1">'&lt;script src="https://d3js.org/d3.v3.min.js" charset="utf-8"&gt;&lt;/script&gt;'</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<script src="https://d3js.org/d3.v3.min.js" charset="utf-8"></script>
</div>

</div>

</div>
</div>

</div>
    

</div>

<script type="application/vnd.jupyter.widget-state+json">
{"state": {"04f327f8729c4dfb8064560e564bc0c6": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "ButtonStyleModel", "state": {}}, "527b16c6484f41a8bbea8b6f91ee4137": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "ButtonStyleModel", "state": {}}, "55400c05e9674a448f4e1fca689799eb": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "ButtonStyleModel", "state": {}}, "6d2c241530244303bf40c0e3b075e4ce": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {}}, "876403260ccd4a0a8d22c264a6912605": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {}}, "91e9ccd185a845428527d57ccb73fb26": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {}}, "9f021bc8541a4b19862488ae989a54bf": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "ButtonModel", "state": {"description": "Model Accuracy", "layout": "IPY_MODEL_dd9515246a5c4b2c8378751eaa36df79", "style": "IPY_MODEL_04f327f8729c4dfb8064560e564bc0c6"}}, "9f1a03a9c53344238bee47b914fa8692": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "ButtonModel", "state": {"description": "Click to see Vocab", "layout": "IPY_MODEL_876403260ccd4a0a8d22c264a6912605", "style": "IPY_MODEL_527b16c6484f41a8bbea8b6f91ee4137"}}, "dd9515246a5c4b2c8378751eaa36df79": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {}}, "eec603a2a46d48bfbb6570ddefcc6477": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "ButtonModel", "state": {"description": "Model Accuracy", "layout": "IPY_MODEL_91e9ccd185a845428527d57ccb73fb26", "style": "IPY_MODEL_f8efef0d43ab4f32b7ab103f009ffe3b"}}, "f7141bc2f4b84b2daf37332f22af3d8f": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "ButtonModel", "state": {"description": "Click to see Vocab", "layout": "IPY_MODEL_6d2c241530244303bf40c0e3b075e4ce", "style": "IPY_MODEL_55400c05e9674a448f4e1fca689799eb"}}, "f8efef0d43ab4f32b7ab103f009ffe3b": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "ButtonStyleModel", "state": {}}}, "version_major": 2, "version_minor": 0}
</script>



  </div><a class="u-url" href="/capstone-notebooks/2021/01/10/Text-Classification.html" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/capstone-notebooks/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/capstone-notebooks/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/capstone-notebooks/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>An easy to use blogging platform with support for Jupyter Notebooks.</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/fastai" title="fastai"><svg class="svg-icon grey"><use xlink:href="/capstone-notebooks/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://twitter.com/fastdotai" title="fastdotai"><svg class="svg-icon grey"><use xlink:href="/capstone-notebooks/assets/minima-social-icons.svg#twitter"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
